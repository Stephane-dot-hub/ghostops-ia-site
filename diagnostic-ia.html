<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>GhostOps Diagnostic IA – Lecture tactique de situations sensibles</title>
    <meta name="description" content="Diagnostic IA GhostOps – 90 minutes pour obtenir une lecture tactique structurée d’une situation sensible : acteurs, lignes de tension, risques humains, de gouvernance et narratifs, sans plan d’action détaillé." />
    <link rel="canonical" href="https://www.ghostops.tech/diagnostic-ia.html" />

    <!-- Open Graph -->
    <meta property="og:title" content="GhostOps Diagnostic IA – Lecture tactique de situations sensibles" />
    <meta property="og:description" content="Un diagnostic IA confidentiel de 90 minutes pour structurer la lecture d’une crise RH, d’un dirigeant exposé ou d’un jeu de pouvoir interne, sans déclencher immédiatement une mission GhostOps." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.ghostops.tech/diagnostic-ia.html" />
    <meta property="og:image" content="https://www.ghostops.tech/assets/ghostops-opengraph.jpg" />

    <!-- Breadcrumbs Diagnostic IA -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Accueil",
          "item": "https://www.ghostops.tech/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Diagnostic IA",
          "item": "https://www.ghostops.tech/diagnostic-ia.html"
        }
      ]
    }
    </script>

    <!-- WebPage Diagnostic IA GhostOps -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "url": "https://www.ghostops.tech/diagnostic-ia.html",
      "name": "GhostOps Diagnostic IA – Lecture tactique de situations sensibles",
      "description": "Diagnostic IA GhostOps – 90 minutes pour obtenir une lecture tactique structurée d’une situation sensible : acteurs, lignes de tension, risques humains, de gouvernance et narratifs, sans plan d’action détaillé."
    }
    </script>

    <!-- JSON-LD FAQ Diagnostic IA -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "À qui s’adresse le Diagnostic IA GhostOps ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Le Diagnostic IA GhostOps s’adresse aux PDG, membres de boards, DRH et fonctions support exposées (juridique, finance, compliance) confrontés à des situations sensibles : crise RH latente, dirigeant contesté, contre-pouvoir interne, blocage de gouvernance, intégration post-acquisition complexe."
          }
        },
        {
          "@type": "Question",
          "name": "Le Diagnostic IA GhostOps remplace-t-il une mission de conseil ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Non. Il s’agit d’un pré-diagnostic tactique destiné à structurer la lecture d’une situation sensible. Il ne remplace ni un conseil juridique, ni une mission de conseil humaine, ni un dispositif GhostOps sur mesure lorsque la situation exige un engagement opérationnel."
          }
        },
        {
          "@type": "Question",
          "name": "Que contient le rapport de Diagnostic IA GhostOps ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Le rapport contient un résumé exécutif, une lecture structurée de la situation, une cartographie des acteurs et des lignes de tension, une analyse des risques humains, de gouvernance et narratifs, trois scénarios de trajectoire possibles (dont le statu quo) et une liste de questions clés et de points de vigilance pour la gouvernance."
          }
        },
        {
          "@type": "Question",
          "name": "Le diagnostic suffit-il à résoudre une crise RH ou de gouvernance ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Non. Le Diagnostic IA GhostOps éclaire la situation et met en forme des scénarios, mais la résolution d’une crise, la recomposition de trajectoires de dirigeants ou la neutralisation de contre-pouvoirs internes nécessitent, le cas échéant, un dispositif humain sur mesure, interne ou externe."
          }
        }
      ]
    }
    </script>

    <!-- Fonts & Tailwind -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: { extend: { fontFamily: { sans: ['Inter','sans-serif'] } } }
      };
    </script>

    <style>
      body::before {
        content: "";
        background: url('/assets/background-ghostops.jpg') no-repeat center center fixed;
        background-color: #0f172a;
        background-size: cover;
        animation: bgPulse 10s ease-in-out infinite alternate;
        position: fixed; inset: 0; opacity: 0.25; z-index: -1;
        transition: opacity .4s ease;
      }
      @keyframes bgPulse {
        0% { filter: brightness(1) contrast(1); }
        100% { filter: brightness(1.05) contrast(1.05); }
      }
      .text-shadow { text-shadow: 1px 1px 4px rgba(0,0,0,.6); }
      html { scroll-behavior: smooth; }
      header, main, section, footer { position: relative; z-index: 1; }
    </style>
  </head>

  <body class="bg-gray-900 text-white font-sans leading-relaxed">
    <!-- HEADER -->
    <header class="w-full px-6 md:px-16 py-4 flex items-center justify-between">
      <a href="/index.html" class="text-sm font-semibold tracking-[.25em] text-gray-200 hover:text-white uppercase">
        GHOST<span class="text-gray-400">OPS</span>
      </a>
      <nav class="flex items-center gap-4 text-xs md:text-sm">
        <a href="/index.html" class="text-gray-300 hover:text-white">Accueil</a>
        <a href="/expertise.html" class="text-gray-300 hover:text-white">Expertise</a>
        <a href="/qui-sommes-nous.html" class="text-gray-300 hover:text-white">Qui sommes-nous&nbsp;?</a>
        <a href="/contact.html"
           class="px-3 py-1 border border-gray-400 rounded-full hover:bg-gray-100 hover:text-black transition">
          Contact confidentiel
        </a>
      </nav>
    </header>

    <main class="px-6 md:px-24 pb-24">
      <!-- HERO / INTRO -->
      <section class="max-w-5xl mx-auto mt-8 mb-10">
        <p class="text-xs uppercase tracking-[.25em] text-gray-400 mb-3">
          Diagnostic IA GhostOps · Lecture tactique
        </p>
        <h1 class="text-3xl md:text-4xl font-bold mb-4 text-shadow">
          Diagnostic IA GhostOps – 90&nbsp;minutes pour lire une situation sensible
        </h1>
        <p class="text-gray-200 text-sm md:text-base mb-3">
          Lorsque la situation devient floue – tensions RH, dirigeant contesté, fonction support sous pression,
          blocage de gouvernance – le plus difficile n’est pas d’«&nbsp;agir&nbsp;», mais de
          <span class="font-semibold">comprendre froidement ce qui se joue</span>&nbsp;: acteurs, lignes de tension,
          risques humains et effets possibles sur la gouvernance.
        </p>
        <p class="text-gray-300 text-sm md:text-base">
          Le <span class="font-semibold">Diagnostic IA GhostOps – 90&nbsp;minutes</span> est un dispositif
          court, confidentiel et forfaitaire qui vise à produire une
          <span class="font-semibold">lecture tactique structurée</span> d’une situation sensible,
          sans se substituer à une mission GhostOps humaine ni à vos conseils habituels.
        </p>
        <div class="mt-6 flex flex-col sm:flex-row gap-3">
          <a href="/contact.html"
             class="inline-block px-6 py-3 border border-white rounded-md hover:bg-white hover:text-black transition font-semibold text-sm">
            Demander un Diagnostic IA
          </a>
          <a href="#contenu-rapport"
             class="inline-block px-6 py-3 border border-gray-500 rounded-md hover:bg-gray-100 hover:text-black transition font-semibold text-xs text-gray-200">
            Voir le contenu du rapport
          </a>
        </div>
      </section>

      <!-- À QUI S’ADRESSE LE DIAGNOSTIC -->
      <section class="max-w-5xl mx-auto mb-12">
        <h2 class="text-2xl md:text-3xl font-semibold mb-4 text-shadow">
          À qui s’adresse le Diagnostic IA GhostOps&nbsp;?
        </h2>
        <p class="text-gray-300 text-sm md:text-base mb-6 max-w-3xl">
          Le dispositif est pensé pour des décideurs directement exposés, responsables devant un board,
          un actionnariat ou un collectif de sites, et qui ne peuvent pas se contenter d’une lecture superficielle
          ou d’un récit incomplet.
        </p>
        <div class="grid md:grid-cols-2 gap-6 text-sm">
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">PDG, directeurs généraux, membres de boards</h3>
            <p class="text-gray-300">
              Crises RH latentes, site ou filiale en tension, dirigeant local contesté, signaux d’alerte sur
              une fonction support devenue point de fragilité. Besoin d’un document de travail exploitable
              au niveau direction générale ou board.
            </p>
          </div>
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">DRH groupe, DRH de filiale, fonctions support exposées</h3>
            <p class="text-gray-300">
              Isolement entre le terrain et le siège, injonctions contradictoires, contre-pouvoirs internes,
              exposition personnelle forte. Nécessité de structurer le récit avant de le porter à un board
              ou à des conseils externes.
            </p>
          </div>
        </div>
      </section>

      <!-- QUAND UTILISER -->
      <section class="max-w-5xl mx-auto mb-12">
        <h2 class="text-2xl md:text-3xl font-semibold mb-4 text-shadow">
          Quand utiliser un Diagnostic IA GhostOps&nbsp;?
        </h2>
        <p class="text-gray-300 text-sm md:text-base mb-4 max-w-3xl">
          Le Diagnostic IA est particulièrement adapté lorsque la situation est suffisamment grave
          pour alerter un dirigeant, mais pas encore suffisamment cadrée pour déclencher immédiatement
          une mission visible ou une procédure lourde.
        </p>
        <ul class="list-disc list-inside text-gray-300 text-sm md:text-base space-y-2 max-w-3xl">
          <li>Crise RH ou sociale en train de monter, sans bascule publique à ce stade.</li>
          <li>Dirigeant fragilisé ou contesté, signaux de désalignement avec le board ou le groupe.</li>
          <li>Site industriel ou business unit devenu «&nbsp;point chaud&nbsp;» sans lecture claire des alliances.</li>
          <li>Fonction support (RH, juridique, finance, compliance) transformée en contre-pouvoir de facto.</li>
          <li>Intégration post-acquisition, transition de gouvernance ou arbitrage sensible entre deux lignes hiérarchiques.</li>
        </ul>
      </section>

      <!-- CONTENU DU RAPPORT -->
      <section id="contenu-rapport" class="max-w-5xl mx-auto mb-12">
        <h2 class="text-2xl md:text-3xl font-semibold mb-4 text-shadow">
          Ce que vous recevez à l’issue des 90&nbsp;minutes
        </h2>
        <p class="text-gray-300 text-sm md:text-base mb-6 max-w-3xl">
          À l’issue de la session, vous recevez un rapport structuré de Diagnostic IA GhostOps,
          pensé pour être lisible par un PDG, un board, une DRH ou vos conseils habituels.
        </p>
        <div class="grid md:grid-cols-2 gap-6 text-sm">
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">1. Résumé exécutif</h3>
            <p class="text-gray-300">
              Une page de synthèse sur la nature de la situation, le niveau de tension,
              l’enjeu principal et les points à regarder en priorité au niveau direction générale ou board.
            </p>
          </div>
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">2. Lecture structurée de la situation</h3>
            <p class="text-gray-300">
              Reconstitution du récit sous une forme exploitable&nbsp;: déclencheurs, chronologie simplifiée,
              état actuel, zones d’incertitude et angles morts.
            </p>
          </div>
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">3. Acteurs et lignes de tension</h3>
            <p class="text-gray-300">
              Identification des acteurs clés, de leur niveau d’influence, des postures apparentes et des principales
              lignes de tension&nbsp;: verticales (terrain vs siège) et horizontales (fonctions entre elles).
            </p>
          </div>
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">4. Analyse des risques</h3>
            <p class="text-gray-300">
              Lecture des risques humains / RH, de gouvernance et narratifs&nbsp;: climat social, circuits de décision,
              exposition des dirigeants, perception interne et externe de la situation.
            </p>
          </div>
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">5. Scénarios de trajectoire</h3>
            <p class="text-gray-300">
              Trois scénarios possibles (mouvement affirmé, recomposition progressive, statu quo) avec leurs avantages,
              leurs risques et les conditions minimales de viabilité, sans plan opérationnel détaillé.
            </p>
          </div>
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">6. Questions clés &amp; points de vigilance</h3>
            <p class="text-gray-300">
              Liste de décisions à trancher, de points à éclairer avec vos conseils et de signaux d’alerte à suivre.
              Ce bloc sert de support de travail pour un board, un comité ou une éventuelle mission GhostOps.
            </p>
          </div>
        </div>
      </section>

      <!-- CE QUE FAIT / NE FAIT PAS L’IA -->
      <section class="max-w-5xl mx-auto mb-12">
        <h2 class="text-2xl md:text-3xl font-semibold mb-4 text-shadow">
          Ce que fait l’IA GhostOps – et ce qu’elle ne fait pas
        </h2>
        <div class="grid md:grid-cols-2 gap-6 text-sm">
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">Ce que fait l’IA GhostOps</h3>
            <ul class="list-disc list-inside text-gray-300 space-y-1">
              <li>Structure un récit souvent fragmenté ou émotionnel.</li>
              <li>Met en évidence des acteurs, des lignes de tension et des blocages probables.</li>
              <li>Classe les risques en dimensions humaines, de gouvernance et narratives.</li>
              <li>Propose des scénarios de trajectoire, sans trancher à votre place.</li>
              <li>Produit une matière exploitable par une direction générale, un board ou vos conseils.</li>
            </ul>
          </div>
          <div class="bg-gray-800/80 rounded-xl p-5">
            <h3 class="font-semibold mb-2">Ce que l’IA GhostOps ne fait pas</h3>
            <ul class="list-disc list-inside text-gray-300 space-y-1">
              <li>Ne fournit ni conseil juridique, ni avis réglementaire ou fiscal.</li>
              <li>Ne décrit pas de plan d’action opérationnel détaillé ni de rétroplanning clef en main.</li>
              <li>Ne rédige pas de courriers, scripts de négociation ou éléments de langage prêts à l’emploi.</li>
              <li>Ne se substitue pas à vos conseils habituels ni à une intervention humaine GhostOps.</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- TARIFICATION / MODALITÉS -->
      <section class="max-w-5xl mx-auto mb-12">
        <h2 class="text-2xl md:text-3xl font-semibold mb-4 text-shadow">
          Tarification et modalités
        </h2>
        <p class="text-gray-300 text-sm md:text-base mb-3 max-w-3xl">
          Le Diagnostic IA GhostOps – 90&nbsp;minutes est proposé sous la forme d’un
          <span class="font-semibold">forfait unique</span>, couvrant la session interactive, la production du rapport
          et sa mise à disposition sécurisée.
        </p>
        <p class="text-gray-400 text-xs md:text-sm max-w-3xl mb-3">
          Le montant est communiqué sur demande ou dans le cadre d’un échange préliminaire. Il peut, le cas échéant,
          être partiellement imputé sur une mission GhostOps ultérieure si un dispositif humain sur mesure est activé.
        </p>
        <p class="text-gray-300 text-sm md:text-base max-w-3xl">
          À ce stade, l’activation du Diagnostic IA se fait via un contact direct&nbsp;:
          vous décrivez brièvement la situation, GhostOps vérifie qu’elle relève bien du périmètre du Diagnostic IA
          puis vous propose, si cela est pertinent, les modalités pratiques (cadre, calendrier, confidentialité).
        </p>
        <div class="mt-5">
          <a href="/contact.html"
             class="inline-block px-6 py-3 border border-white rounded-md hover:bg-white hover:text-black transition font-semibold text-sm">
            Activer un Diagnostic IA GhostOps
          </a>
        </div>
      </section>

      <!-- FAQ SYNTHÉTIQUE -->
      <section class="max-w-5xl mx-auto mb-16">
        <h2 class="text-2xl md:text-3xl font-semibold mb-4 text-shadow">
          FAQ – Diagnostic IA GhostOps
        </h2>
        <div class="bg-gray-800/80 rounded-xl p-6 md:p-8 text-sm space-y-5">
          <div>
            <h3 class="font-semibold text-gray-100 mb-1">
              Le diagnostic est-il pleinement confidentiel&nbsp;?
            </h3>
            <p class="text-gray-300">
              Oui. Le dispositif est conçu pour traiter des situations sensibles. Les informations partagées
              servent exclusivement à produire le diagnostic. Elles ne sont ni revendues ni utilisées à des fins
              marketing. Si un niveau de protection supérieur est requis, il peut être envisagé dans le cadre d’une
              intervention GhostOps humaine.
            </p>
          </div>
          <div>
            <h3 class="font-semibold text-gray-100 mb-1">
              Le diagnostic suffit-il à lui seul à «&nbsp;résoudre&nbsp;» une crise&nbsp;?
            </h3>
            <p class="text-gray-300">
              Non. Le Diagnostic IA éclaire la situation, met en forme des scénarios et des points de vigilance.
              La résolution effective d’une crise, la recomposition de trajectoires de dirigeants ou la neutralisation
              de contre-pouvoirs internes nécessitent un dispositif humain sur mesure, interne ou externe.
            </p>
          </div>
          <div>
            <h3 class="font-semibold text-gray-100 mb-1">
              Puis-je partager le rapport avec mon board ou mes conseils&nbsp;?
            </h3>
            <p class="text-gray-300">
              Oui. Le rapport est conçu pour être partageable avec une direction générale, un board, un comité exécutif
              ou vos conseils (juridique, RH, communication). Il constitue une base de travail, librement utilisable.
            </p>
          </div>
          <div>
            <h3 class="font-semibold text-gray-100 mb-1">
              Le diagnostic peut-il servir de base à une intervention GhostOps&nbsp;?
            </h3>
            <p class="text-gray-300">
              Oui. S’il apparaît que le niveau de risque est élevé ou la situation structurellement instable,
              le Diagnostic IA peut servir de pré-brief pour une intervention GhostOps humaine. Il accélère la prise en
              main du dossier et peut, le cas échéant, être partiellement imputé sur la mission.
            </p>
          </div>
        </div>
      </section>

      <!-- CTA FINAL -->
      <section class="max-w-5xl mx-auto">
        <div class="bg-gray-800/80 rounded-2xl p-8 md:p-10 text-center">
          <h2 class="text-2xl md:text-3xl font-semibold mb-3 text-shadow">
            Exposer une situation en toute confidentialité
          </h2>
          <p class="text-gray-300 text-sm md:text-base mb-4">
            Si vous estimez qu’une situation mérite une lecture structurée avant toute décision visible,
            le Diagnostic IA GhostOps peut constituer un point d’appui utile. Il ne remplace ni un conseil
            juridique, ni une mission GhostOps humaine, mais il permet de regarder la situation sans filtre
            et de préparer des arbitrages réellement informés.
          </p>
          <a href="/contact.html"
             class="inline-block px-6 py-3 border border-white rounded-md hover:bg-white hover:text-black transition font-semibold text-sm">
            Décrire une situation à GhostOps
          </a>
        </div>
      </section>
    </main>

    <footer class="w-full px-6 md:px-24 pb-8 mt-8 md:mt-12 text-xs text-gray-400">
      <div class="max-w-5xl mx-auto flex flex-col md:flex-row md:items-center md:justify-between gap-2">
        <p>© GhostOps – Tous droits réservés.</p>
        <nav class="flex flex-wrap items-center gap-3">
          <a href="/" class="hover:underline">Accueil</a>
          <a href="/expertise.html" class="hover:underline">Expertise</a>
          <a href="/qui-sommes-nous.html" class="hover:underline">Qui sommes-nous&nbsp;?</a>
          <a href="/contact.html" class="hover:underline">Contact</a>
          <a href="/mentions-legales.html" class="hover:underline">
            Mentions légales &amp; confidentialité
          </a>
        </nav>
      </div>
    </footer>

    <!-- Widget GhostOps Chat (identique à index.html) -->
    <div id="ghostops-chat-root">
      <!-- Bouton flottant -->
      <button id="ghostops-chat-toggle"
              class="fixed bottom-6 right-6 z-40 rounded-full px-4 py-3 text-sm font-semibold bg-gray-800 text-white border border-gray-500 shadow-lg hover:bg-white hover:text-black transition">
        GhostOps Chat
      </button>

      <!-- Fenêtre de chat -->
      <div id="ghostops-chat-window"
           class="hidden fixed bottom-20 right-6 z-40 w-80 max-h-[70vh] bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl flex flex-col">
        <div class="px-4 py-3 border-b border-gray-700 flex items-center justify-between">
          <div>
            <p class="text-[10px] uppercase tracking-[.25em] text-gray-400 mb-0.5">Assistant</p>
            <p class="text-sm font-semibold text-white">GhostOps – Chat confidentiel</p>
          </div>
          <button id="ghostops-chat-close" class="text-gray-400 hover:text-white text-lg leading-none">&times;</button>
        </div>

        <!-- Zone des messages -->
        <div id="ghostops-chat-messages"
             class="flex-1 px-4 py-3 space-y-3 overflow-y-auto text-xs bg-gray-950/80">
          <div class="text-gray-300">
            <span class="font-semibold">GhostOps&nbsp;:</span>
            <span>
              Vous pouvez décrire en quelques lignes votre situation (crise RH, dirigeant exposé, jeux de pouvoir internes).
              L’assistant GhostOps IA produit une première lecture à visée opérationnelle. Il ne remplace pas un avis juridique.
            </span>
          </div>
        </div>

        <!-- Formulaire d’envoi -->
        <form id="ghostops-chat-form" class="border-t border-gray-800 px-3 py-2 flex items-center gap-2">
          <textarea id="ghostops-chat-input"
                    class="flex-1 text-xs bg-gray-900 text-gray-100 border border-gray-700 rounded-md px-2 py-1 resize-none focus:outline-none focus:border-gray-400"
                    rows="2"
                    placeholder="Décrivez brièvement votre situation…"></textarea>
          <button type="submit"
                  class="text-xs px-3 py-2 bg-white text-black font-semibold rounded-md hover:bg-gray-200">
            Envoyer
          </button>
        </form>
      </div>
    </div>

    <!-- Script GhostOps Chat -->
    <script>
      (function () {
        const toggleBtn  = document.getElementById('ghostops-chat-toggle');
        const panel      = document.getElementById('ghostops-chat-window');
        const closeBtn   = document.getElementById('ghostops-chat-close');
        const form       = document.getElementById('ghostops-chat-form');
        const input      = document.getElementById('ghostops-chat-input');
        const messages   = document.getElementById('ghostops-chat-messages');

        if (!toggleBtn || !panel || !closeBtn || !form || !input || !messages) return;

        function scrollToBottom() {
          messages.scrollTop = messages.scrollHeight;
        }

        function addMessage(sender, text) {
          const wrapper = document.createElement('div');
          wrapper.className = sender === 'user'
            ? 'mb-2 text-right'
            : 'mb-2 text-left';

          const bubble = document.createElement('div');
          bubble.className = sender === 'user'
            ? 'inline-block bg-blue-500 text-white text-xs md:text-sm px-3 py-2 rounded-lg'
            : 'inline-block bg-gray-800 text-gray-100 text-xs md:text-sm px-3 py-2 rounded-lg';

          bubble.textContent = text;
          wrapper.appendChild(bubble);
          messages.appendChild(wrapper);
          scrollToBottom();
          return wrapper;
        }

        toggleBtn.addEventListener('click', () => {
          panel.classList.toggle('hidden');
          if (!panel.classList.contains('hidden')) {
            input.focus();
            scrollToBottom();
          }
        });

        closeBtn.addEventListener('click', () => {
          panel.classList.add('hidden');
        });

        async function sendMessage() {
          const userMessage = (input.value || '').trim();
          if (!userMessage) return;

          addMessage('user', userMessage);
          input.value = '';

          const waitingElem = addMessage('bot', 'Analyse en cours…');

          try {
            const response = await fetch('/api/ghostops-chat', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ message: userMessage })
            });

            let data = {};
            try {
              data = await response.json();
            } catch (_) {}

            if (waitingElem && waitingElem.parentNode) {
              waitingElem.parentNode.removeChild(waitingElem);
            }

            if (!response.ok || !data.reply) {
              const errText = data.error || 'Une erreur est survenue côté moteur GhostOps.';
              addMessage('bot', errText);
              return;
            }

            addMessage('bot', data.reply);
          } catch (err) {
            console.error('Erreur lors de l’appel /api/ghostops-chat :', err);
            if (waitingElem && waitingElem.parentNode) {
              waitingElem.parentNode.removeChild(waitingElem);
            }
            addMessage('bot', 'Erreur de connexion au moteur GhostOps. Veuillez réessayer ultérieurement.');
          }
        }

        form.addEventListener('submit', (e) => {
          e.preventDefault();
          sendMessage();
        });

        input.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMessage();
          }
        });
      })();
    </script>
  </body>
</html>
